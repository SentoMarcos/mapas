<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Museo Sonoro 췅 Direcci칩n musical</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="estilos-mapas.css" />
  <script src="scripts/audio-player.js" defer></script>
  <script src="scripts/timeline.js" defer></script>
</head>

<body class="theme-direccion">
  <header class="page-hero">
    <nav class="site-nav" aria-label="Navegaci칩n principal">
      <a class="brand-mark" href="index.html">Museo Sonoro</a>
      <div class="nav-links">
        <a href="cuerda.html">Cuerda</a>
        <a href="percusion.html">Percusi칩n</a>
        <a href="viento.html">Viento</a>
        <a href="produccion.html">Producci칩n</a>
        <a href="direccion.html" class="is-active">Direcci칩n</a>
      </div>
    </nav>

    <div class="hero-grid">
      <div class="hero-text">
        <p class="hero-label">Podios conectados</p>
        <h1>Direcci칩n musical</h1>
        <p class="hero-copy">Explora la evoluci칩n del gesto que articula orquestas: de la quironimia medieval al director multimedia que sincroniza cine, escenarios digitales y giras globales.</p>

        <div class="hero-meta">
          <div>
            <span>Obras guiadas</span>
            <strong>12 hitos</strong>
          </div>
          <div>
            <span>Solistas coordinados</span>
            <strong>80+</strong>
          </div>
          <div>
            <span>Podios globales</span>
            <strong>5 continentes</strong>
          </div>
        </div>

        <div class="hero-actions">
          <a class="btn-primary" href="#linea-direccion">Seguir la l칤nea</a>
          <a class="btn-ghost" href="#mapa-direccion">Explorar mapa</a>
        </div>
      </div>

      <div class="hero-visual">
        <h3>Gestos que cuentan historias</h3>
        <p>El director traduce partituras en energ칤a compartida: respiraci칩n, mirada y tecnolog칤a hacen que cada comp치s cobre vida.</p>

        <div class="hero-timeline-blip">
          <article>
            <span>Origen</span>
            <strong>Quironimia coral</strong>
            <p>Los primeros gestos con mano abierta esculpen frases en monasterios.</p>
          </article>
          <article>
            <span>Revoluci칩n</span>
            <strong>Batuta rom치ntica</strong>
            <p>Mahler y Toscanini convierten al director en voz art칤stica propia.</p>
          </article>
          <article>
            <span>Presente</span>
            <strong>Podio digital</strong>
            <p>Click-tracks, realidad mixta y diversidad ampl칤an el repertorio.</p>
          </article>
        </div>

        <ul class="hero-taglist" aria-label="Conceptos clave de direcci칩n">
          <li>Quironimia</li>
          <li>Batuta</li>
          <li>Score follower</li>
          <li>Orquestas j칩venes</li>
          <li>Click-track</li>
        </ul>
      </div>
    </div>
  </header>

  <main class="page-content">
    <section class="panel-card timeline-panel" id="linea-direccion">
      <div class="panel-inner">
        <div class="section-heading">
          <span class="section-kicker">Historia viva</span>
          <h2>L칤nea del tiempo de la direcci칩n orquestal</h2>
          <p>Desde la quironimia medieval hasta los podios tecnol칩gicos del siglo XXI.</p>
        </div>

        <div class="timeline" aria-label="L칤nea del tiempo interactiva">
          <button class="timeline-reset" type="button" aria-label="Volver al inicio">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 5v14M5 12l7-7 7 7" />
            </svg>
          </button>
        <div class="timeline-track">
      <svg class="timeline-curve" viewBox="0 0 1200 320" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <linearGradient id="timelineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#f4a261" />
            <stop offset="25%" stop-color="#2a9d8f" />
            <stop offset="50%" stop-color="#457b9d" />
            <stop offset="75%" stop-color="#e76f51" />
            <stop offset="100%" stop-color="#9b5de5" />
          </linearGradient>
        </defs>
        <path d="M0,220 C160,120 320,280 480,180 S800,280 960,180 1120,260 1200,220" stroke="url(#timelineGradient)" />
      </svg>

      <div class="timeline-event side-top" style="--pos:6%;" data-progress="0.06">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Antig칲edad</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Edad Media</span>
        </div>
        <div class="periodo era-medieval">
          <h4>Quironimia y manos al aire</h4>
          <ul>
            <li>En Grecia y en el canto gregoriano se dirige con gestos manuales.</li>
            <li>Los l칤deres indican subidas, bajadas y frases sin compases modernos.</li>
            <li>La batuta a칰n no existe; el cuerpo es la herramienta.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:18%;" data-progress="0.18">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XVII</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Barroco</span>
        </div>
        <div class="periodo era-renaissance">
          <h4>El bast칩n de Lully</h4>
          <ul>
            <li>Jean-Baptiste Lully populariza un bast칩n largo para marcar el pulso.</li>
            <li>Golpea el suelo frente a la corte de Luis XIV para sincronizar grandes conjuntos.</li>
            <li>El m칠todo es efectivo, ruidoso y arriesgado (su accidente le cost칩 la vida).</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:32%;" data-progress="0.32">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Inicios s. XIX</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Stehgeiger</span>
        </div>
        <div class="periodo era-classical">
          <h4>Dirigir desde el instrumento</h4>
          <ul>
            <li>Primer viol칤n o clavecinista lideran mientras tocan.</li>
            <li>Movimientos del arco, cabeza y mirada cuean entradas.</li>
            <li>Todav칤a no existe un director independiente.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:48%;" data-progress="0.48">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">1820</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Batuta</span>
        </div>
        <div class="periodo era-classical">
          <h4>Nace la batuta moderna</h4>
          <ul>
            <li>Louis Spohr y Felix Mendelssohn estandarizan una batuta ligera.</li>
            <li>El director deja de tocar y se coloca frente a la orquesta, de espaldas al p칰blico.</li>
            <li>Se consolida la figura profesional del director.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:64%;" data-progress="0.64">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Finales s. XIX</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Maestros</span>
        </div>
        <div class="periodo era-modern">
          <h4>Director como artista</h4>
          <ul>
            <li>Wagner y Mahler redefinen la direcci칩n como interpretaci칩n creativa.</li>
            <li>Rubati, balances y dramatismo quedan en manos del maestro.</li>
            <li>Nace el culto al director estrella.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:80%;" data-progress="0.80">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XX</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Grabaci칩n</span>
        </div>
        <div class="periodo era-modern">
          <h4>La era de los titanes</h4>
          <ul>
            <li>Toscanini, Karajan o Bernstein se vuelven referentes globales.</li>
            <li>La grabaci칩n exige precisi칩n, repetibilidad y gestualidad codificada.</li>
            <li>Se profesionaliza la t칠cnica: independencia de manos y claridad r칤tmica.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:94%;" data-progress="0.94">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XXI</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Diversidad</span>
        </div>
        <div class="periodo era-contemporary">
          <h4>Podios diversos y tecnol칩gicos</h4>
          <ul>
            <li>Aumentan mujeres y directores latinoamericanos, asi치ticos y africanos.</li>
            <li>Ejemplos: Marin Alsop, Alondra de la Parra, Gustavo Dudamel.</li>
            <li>Click-tracks y sincron칤a audiovisual para cine, videojuegos y espect치culos multimedia.</li>
          </ul>
        </div>
      </div>
          </div>
        </div>

        <p class="timeline-hint">游꿮 Despl치zate horizontalmente o usa la rueda para seguir cada etapa del arte de dirigir.</p>
      </div>
    </section>

    <section class="panel-card map-panel" id="mapa-direccion">
      <div class="panel-inner">
        <div class="map-meta">
          <div class="section-heading">
            <span class="section-kicker">Geograf칤a</span>
            <h2>Mapa de podios y escuelas</h2>
            <p>Palacios, teatros y academias que forjaron el lenguaje del gesto orquestal.</p>
          </div>
          <ul>
            <li>Puntos donde se estandariza la batuta moderna.</li>
            <li>Escuelas que profesionalizan la t칠cnica y la pedagog칤a.</li>
            <li>Centros que impulsan la diversidad de directores contempor치neos.</li>
          </ul>
        </div>

        <div id="map" aria-label="Mapa interactivo de direcci칩n"></div>
      </div>
    </section>

    <section class="panel-card audio-panel">
      <div class="panel-inner">
        <div class="section-heading">
          <span class="section-kicker">Experiencia museo con guias</span>
          <h2>Escucha a Orfeo</h2>
          <p>Orfeo ser치 el guia que te acompa침ar치 por el museo interactivo con explicaciones claras y accesibles.</p>
          <p>Aqu칤 te mostramos un poco lo que nos contar칤a el dios griego Orfeo sobre la direcci칩n y los diferentes grupos musicales.</p>
        </div>

        <div class="audio-showcase">
          <article class="audio-player">
            <h3>Reproductor</h3>
            <div class="custom-audio" data-track="Orfeo">
              <div class="audio-controls">
                <button class="audio-toggle" type="button" aria-label="Reproducir Orfeo"></button>
                <div class="audio-info">
                  <span class="audio-label">Sesi칩n</span>
                  <strong>Orfeo</strong>
                  <div class="audio-time">
                    <span class="audio-current">0:00</span>
                    <span class="audio-separator">/</span>
                    <span class="audio-duration">0:00</span>
                  </div>
                </div>
              </div>
              <div class="audio-timeline" role="progressbar" aria-label="Progreso Orfeo" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0">
                <div class="audio-progress"></div>
              </div>
              <canvas class="audio-wave" width="600" height="140" aria-hidden="true"></canvas>
              <audio preload="metadata">
                <source src="audio/orfeo - direccion.wav" type="audio/wav" />
                Tu navegador no soporta audio HTML5.
              </audio>
            </div>
          </article>
        </div>
      </div>
    </section>
  </main>

  <footer class="page-footer">
    <p>Mapa interactivo elaborado para el proyecto de historia musical.</p>
  </footer>

    <script>
      (function () {
        function clamp(value, min, max) {
          return Math.min(Math.max(value, min), max);
        }

        function syncTrack(track) {
          var svg = track.querySelector('.timeline-curve');
          if (!svg) return;
          var path = svg.querySelector('path');
          if (!path) return;

          var viewBox = svg.viewBox.baseVal;
          var pathLength = path.getTotalLength();
          var trackRect = track.getBoundingClientRect();
          var svgRect = svg.getBoundingClientRect();
          var offsetX = svgRect.left - trackRect.left;
          var offsetY = svgRect.top - trackRect.top;
          var ratioX = svgRect.width / viewBox.width;
          var ratioY = svgRect.height / viewBox.height;

          track.querySelectorAll('.timeline-event').forEach(function (eventEl) {
            var progressAttr = parseFloat(eventEl.dataset.progress);
            var cssPos = eventEl.style.getPropertyValue('--pos').replace('%', '').trim();
            var fallbackProgress = cssPos ? parseFloat(cssPos) / 100 : 0;
            var progress = clamp(isNaN(progressAttr) ? fallbackProgress : progressAttr, 0, 1);
            var point = path.getPointAtLength(pathLength * progress);

            var relativeX = offsetX + point.x * ratioX;
            var relativeY = offsetY + point.y * ratioY;
            var xPercent = (relativeX / trackRect.width) * 100;
            var yPercent = (relativeY / trackRect.height) * 100;

            eventEl.style.setProperty('--pos', xPercent + '%');
            eventEl.style.setProperty('--node-anchor', yPercent + '%');
          });
        }

        function syncAll() {
          document.querySelectorAll('.timeline-track').forEach(syncTrack);
        }

        function bindWheelScroll() {
          var timelines = document.querySelectorAll('.timeline');
          timelines.forEach(function (timeline) {
            if (timeline.dataset.wheelBound === 'true') return;
            timeline.dataset.wheelBound = 'true';
            timeline.addEventListener(
              'wheel',
              function (evt) {
                if (evt.ctrlKey) return;
                var delta = Math.abs(evt.deltaY) > Math.abs(evt.deltaX) ? evt.deltaY : evt.deltaX;
                if (delta === 0) return;

                var prev = timeline.scrollLeft;
                var maxScroll = timeline.scrollWidth - timeline.clientWidth;
                if (maxScroll <= 0) return;

                var next = Math.min(Math.max(prev + delta, 0), maxScroll);
                timeline.scrollLeft = next;

                if (next !== prev) {
                  evt.preventDefault();
                }
              },
              { passive: false }
            );
          });
        }

        function init() {
          syncAll();
          bindWheelScroll();
        }

        window.addEventListener('resize', syncAll);
        window.addEventListener('load', init);
        init();
      })();
    </script>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([20, 0], 2);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 18,
      attribution: '춸 OpenStreetMap, 춸 Carto'
    }).addTo(map);

    var puntos = [
      {
        coords: [48.8, 2.12],
        texto: "<b>Versalles, Francia</b><br>Jean-Baptiste Lully y el bast칩n barroco."
      },
      {
        coords: [51.34, 12.37],
        texto: "<b>Leipzig, Alemania</b><br>Mendelssohn y la batuta moderna."
      },
      {
        coords: [48.21, 16.37],
        texto: "<b>Viena, Austria</b><br>Johann Strauss y la tradici칩n del stehgeiger." 
      },
      {
        coords: [49.95, 11.58],
        texto: "<b>Bayreuth, Alemania</b><br>Wagner y el foso cubierto para enfocar la atenci칩n." 
      },
      {
        coords: [10.48, -66.9],
        texto: "<b>Caracas, Venezuela</b><br>'El Sistema' y nuevas generaciones de directores." 
      }
    ];

    puntos.forEach(function(p) {
      L.marker(p.coords).addTo(map).bindPopup(p.texto);
    });
  </script>
</body>
</html>

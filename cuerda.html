<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Mapa de instrumentos de cuerda</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="estilos-mapas.css" />
</head>

<body>
  <header class="page-hero">
    <p class="hero-label">Atlas sonoro global</p>
    <h1>Instrumentos de cuerda</h1>
    <p class="hero-copy">Explora c√≥mo la cuerda ha conectado civilizaciones: de las primeras arpas mesopot√°micas al sonido el√©ctrico contempor√°neo.</p>
  </header>

  <main class="page-content">
    <section class="panel-card timeline-panel">
      <div class="section-heading">
        <span class="section-kicker">Historia viva</span>
        <h2>L√≠nea del tiempo de los instrumentos de cuerda</h2>
        <p>Recorre hitos musicales y descubre c√≥mo cada cultura aport√≥ nuevas formas, materiales y repertorios.</p>
      </div>

      <div class="timeline" aria-label="L√≠nea del tiempo interactiva">
        <div class="timeline-track">
      <svg class="timeline-curve" viewBox="0 0 1200 400" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <linearGradient id="timelineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#f4a261" />
            <stop offset="25%" stop-color="#2a9d8f" />
            <stop offset="50%" stop-color="#457b9d" />
            <stop offset="75%" stop-color="#e76f51" />
            <stop offset="100%" stop-color="#9b5de5" />
          </linearGradient>
        </defs>
        <path d="M0,260 C120,60 240,360 360,160 S600,360 720,200 960,360 1080,160 1200,320 1200,220" stroke="url(#timelineGradient)" />
      </svg>

      <div class="timeline-event side-top" style="--pos:4%;" data-progress="0.04">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">3000 a.C.</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">1000 a.C.</span>
        </div>
        <div class="periodo era-ancient">
          <h4>c. 3000‚Äì1000 a.C. ‚Äì Mesopotamia y Egipto</h4>
          <ul>
            <li>Liras sumerias y arpas egipcias aparecen en rituales cortesanos.</li>
            <li>Cuerdas de tripa y cajas de madera decoradas con simbolog√≠a divina.</li>
            <li>Acompa√±an ceremonias f√∫nebres y ofrendas templarias.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:12%;" data-progress="0.12">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">1000 a.C.</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">300 a.C.</span>
        </div>
        <div class="periodo era-ancient">
          <h4>c. 1000‚Äì300 a.C. ‚Äì Grecia antigua</h4>
          <ul>
            <li>Lira y kithara acompa√±an poes√≠a, filosof√≠a y teatro.</li>
            <li>Educaci√≥n musical vinculada al ideal de armon√≠a social.</li>
            <li>Los concursos panhel√©nicos consolidan repertorios heroicos.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:22%;" data-progress="0.22">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Edad Antigua</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Alta Edad Media</span>
        </div>
        <div class="periodo era-ancient">
          <h4>Pueblos celtas, escitas y n√≥rdicos</h4>
          <ul>
            <li>Bardos y skalds usan liras para narrar batallas y genealog√≠as.</li>
            <li>Las cortes tribales legitiman poder mediante m√∫sica ritual.</li>
            <li>Instrumentos port√°tiles permiten cr√≥nicas itinerantes.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:32%;" data-progress="0.32">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">China</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Antigua</span>
        </div>
        <div class="periodo era-ancient">
          <h4>Guqin y guzheng</h4>
          <ul>
            <li>Instrumentos asociados a sabios confucianos y poetas.</li>
            <li>Se emplean en rituales militares y ex√°menes imperiales.</li>
            <li>Desarrollan afinaciones modales transmitidas por tablaturas.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:42%;" data-progress="0.42">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo IX</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Siglo XIV</span>
        </div>
        <div class="periodo era-medieval">
          <h4>Europa medieval</h4>
          <ul>
            <li>Zanfona, salterio y la√∫d acompa√±an cantares de gesta y liturgia.</li>
            <li>Monasterios copian tratados que definen afinaciones.</li>
            <li>Trovadores y juglares difunden repertorios por rutas comerciales.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:52%;" data-progress="0.52">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XV</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Siglo XVI</span>
        </div>
        <div class="periodo era-renaissance">
          <h4>Renacimiento cortesano</h4>
          <ul>
            <li>El la√∫d simboliza refinamiento y diplomacia.</li>
            <li>Surgen tablaturas impresas y escuelas virtuos√≠sticas.</li>
            <li>El viol√≠n renacentista evoluciona en talleres italianos.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:62%;" data-progress="0.62">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Jap√≥n</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Asia oriental</span>
        </div>
        <div class="periodo era-renaissance">
          <h4>Koto, biwa y shamisen</h4>
          <ul>
            <li>Gagaku imperial emplea koto y biwa en ceremonias estatales.</li>
            <li>El teatro Kabuki usa shamisen para acentuar emociones.</li>
            <li>Las escuelas jiuta definen repertorios camer√≠sticos.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:72%;" data-progress="0.72">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XVII</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Siglo XVIII</span>
        </div>
        <div class="periodo era-classical">
          <h4>Barroco y Clasicismo</h4>
          <ul>
            <li>Familias Amati, Guarneri y Stradivari perfeccionan violines.</li>
            <li>Las cuerdas se convierten en columna vertebral de la orquesta.</li>
            <li>Nacen t√©cnicas como pizzicato, tr√©molo y glissando orquestal.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:82%;" data-progress="0.82">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Cristianismo</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Medieval</span>
        </div>
        <div class="periodo era-medieval">
          <h4>Espiritualidad europea</h4>
          <ul>
            <li>Arpas y violas acompa√±an himnos, procesiones y coronaciones.</li>
            <li>El simbolismo del arpa la vincula con √°ngeles y profetas.</li>
            <li>Surgen capillas musicales permanentes en catedrales.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:88%;" data-progress="0.88">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Veena</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Sitar</span>
        </div>
        <div class="periodo era-ancient">
          <h4>Tradiciones hind√∫es</h4>
          <ul>
            <li>Veena asociada a Saraswati en templos y corte.</li>
            <li>Sitar desarrolla ragas para meditaci√≥n y devoci√≥n bhakti.</li>
            <li>Los gharanas transmiten t√©cnicas de meend y gamakas.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-top" style="--pos:94%;" data-progress="0.94">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XVIII</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Siglo XIX</span>
        </div>
        <div class="periodo era-classical">
          <h4>Orquesta cl√°sica y guitarra rom√°ntica</h4>
          <ul>
            <li>La secci√≥n de cuerda domina por expresividad y rango din√°mico.</li>
            <li>Antonio de Torres redefine la guitarra moderna de seis cuerdas.</li>
            <li>Salones burgueses difunden repertorio de c√°mara y solo.</li>
          </ul>
        </div>
      </div>

      <div class="timeline-event side-bottom" style="--pos:99%;" data-progress="0.99">
        <div class="timeline-node" tabindex="0">
          <span class="fecha-superior">Siglo XX</span>
          <span class="timeline-node-dot" aria-hidden="true"></span>
          <span class="fecha-inferior">Globalizaci√≥n</span>
        </div>
        <div class="periodo era-modern">
          <h4>Electrificaci√≥n y fusiones</h4>
          <ul>
            <li>Nacen guitarra el√©ctrica y bajo el√©ctrico: rock, jazz, pop.</li>
            <li>Violines amplificados protagonizan cine y world music.</li>
            <li>Fusiones globales integran sitar, koto, charango y kora.</li>
          </ul>
        </div>
      </div>
    </div>
      </div>

      <p class="timeline-hint">üìç Usa la rueda del rat√≥n o desliza para recorrer las √©pocas.</p>
    </section>

    <section class="panel-card map-panel">
      <div class="section-heading">
        <span class="section-kicker">Geograf√≠a</span>
        <h2>Mapa de origen y difusi√≥n</h2>
        <p>Visualiza los territorios que dieron forma a los instrumentos emblem√°ticos de cuerda.</p>
      </div>

      <div id="map"></div>
    </section>
  </main>

  <footer class="page-footer">
    <p>Mapa interactivo elaborado para el proyecto de historia musical.</p>
  </footer>

    <script>
      (function () {
        function clamp(value, min, max) {
          return Math.min(Math.max(value, min), max);
        }

        function syncTrack(track) {
          var svg = track.querySelector('.timeline-curve');
          if (!svg) return;
          var path = svg.querySelector('path');
          if (!path) return;

          var viewBox = svg.viewBox.baseVal;
          var pathLength = path.getTotalLength();
          var trackRect = track.getBoundingClientRect();
          var svgRect = svg.getBoundingClientRect();
          var offsetX = svgRect.left - trackRect.left;
          var offsetY = svgRect.top - trackRect.top;
          var ratioX = svgRect.width / viewBox.width;
          var ratioY = svgRect.height / viewBox.height;

          track.querySelectorAll('.timeline-event').forEach(function (eventEl) {
            var progressAttr = parseFloat(eventEl.dataset.progress);
            var cssPos = eventEl.style.getPropertyValue('--pos').replace('%', '').trim();
            var fallbackProgress = cssPos ? parseFloat(cssPos) / 100 : 0;
            var progress = clamp(isNaN(progressAttr) ? fallbackProgress : progressAttr, 0, 1);
            var point = path.getPointAtLength(pathLength * progress);

            var relativeX = offsetX + point.x * ratioX;
            var relativeY = offsetY + point.y * ratioY;
            var xPercent = (relativeX / trackRect.width) * 100;
            var yPercent = (relativeY / trackRect.height) * 100;

            eventEl.style.setProperty('--pos', xPercent + '%');
            eventEl.style.setProperty('--node-anchor', yPercent + '%');
          });
        }

        function syncAll() {
          document.querySelectorAll('.timeline-track').forEach(syncTrack);
        }

        function bindWheelScroll() {
          var timelines = document.querySelectorAll('.timeline');
          timelines.forEach(function (timeline) {
            if (timeline.dataset.wheelBound === 'true') return;
            timeline.dataset.wheelBound = 'true';
            timeline.addEventListener(
              'wheel',
              function (evt) {
                if (evt.ctrlKey) return;
                var delta = Math.abs(evt.deltaY) > Math.abs(evt.deltaX) ? evt.deltaY : evt.deltaX;
                if (delta === 0) return;

                var prev = timeline.scrollLeft;
                var maxScroll = timeline.scrollWidth - timeline.clientWidth;
                if (maxScroll <= 0) return;

                var next = Math.min(Math.max(prev + delta, 0), maxScroll);
                timeline.scrollLeft = next;

                if (next !== prev) {
                  evt.preventDefault();
                }
              },
              { passive: false }
            );
          });
        }

        function init() {
          syncAll();
          bindWheelScroll();
        }

        window.addEventListener('resize', syncAll);
        window.addEventListener('load', init);
        init();
      })();
    </script>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([20, 10], 2);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 18,
      attribution: '¬© OpenStreetMap, ¬© Carto'
    }).addTo(map);

    var puntos = [
      { coords: [31.5, 35], texto: "Creciente F√©rtil<br>Lira sumeria, arpa egipcia y oud temprano." },
      { coords: [37.9, 23.7], texto: "Grecia<br>Kithara y lira cl√°sica en concursos musicales." },
      { coords: [45.1, 10.8], texto: "Cremona, Italia<br>Talleres Amati, Guarneri y Stradivari." },
      { coords: [40.4, -3.7], texto: "Espa√±a<br>Evoluci√≥n de la guitarra barroca a la guitarra espa√±ola." },
      { coords: [28.6, 77.2], texto: "India<br>Veena y sitar en templos y corte mogola." },
      { coords: [34.3, 108.9], texto: "China<br>Guqin y pipa en la corte imperial Tang y Song." },
      { coords: [13.5, -15.6], texto: "√Åfrica Occidental<br>Kora y ngoni de los griots mandingas." },
      { coords: [35.7, 139.7], texto: "Jap√≥n<br>Koto y shamisen en gagaku y kabuki." },
      { coords: [34.0, -118.2], texto: "EE. UU.<br>Electrificaci√≥n: guitarra y bajo revolucionan el siglo XX." }
    ];

    puntos.forEach(function(p) {
      L.marker(p.coords).addTo(map).bindPopup(p.texto);
    });
  </script>
</body>
</html>
